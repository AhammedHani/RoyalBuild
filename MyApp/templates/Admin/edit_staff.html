{% extends 'Admin/admin_home.html' %}
{% block x %}

{% comment %} <head>
  <script>
    function valid()
    {
      if(f1.staff_type.value=="Permanent")
      {
document.getElementById("salary").style.display="block";
      }
      if(f1.staff_type.value=="Temporary")
      {
document.getElementById("salary").style.display="none";
      }
    }
  </script>
</head> {% endcomment %}
<head>
  <script>
    function valid()
{
  var postSelect = document.getElementById("post");
  var salaryTable = document.getElementById("salary_table");
  var salaryInput = document.getElementById("salary");
  var currentPost = "{{ data.post }}"; // Get the current post from Django
  if(f1.staff_type.value=="Permanent")
  {
    salaryTable.style.display="block";
    salaryInput.value = "{{ data.salary }}"; // Set the salary value
    postSelect.innerHTML = `
      <option value="" disabled>Select a post</option>
      <option value="driver" ${currentPost == "driver" ? "selected" : ""}>Driver</option>
      <option value="labour" ${currentPost == "labour" ? "selected" : ""}>Labour</option>
      <option value="accountant" ${currentPost == "accountant" ? "selected" : ""}>Accountant</option>
      <option value="scheduler" ${currentPost == "scheduler" ? "selected" : ""}>Manager</option>
    `;
  }
  if(f1.staff_type.value=="Temporary")
  {
    salaryTable.style.display="none";
    salaryInput.value = ""; // Clear the salary value
    postSelect.innerHTML = `
      <option value="" disabled>Select a post</option>
      <option value="driver" ${currentPost == "driver" ? "selected" : ""}>Driver</option>
      <option value="labour" ${currentPost == "labour" ? "selected" : ""}>Labour</option>
    `;
  }
      updateSalaryRange();
    }

    function updateSalaryRange()
    {
      var salaryInput = document.getElementById("salary");
      switch(f1.post.value)
      {
        case "labour":
          salaryInput.min = 5000;
          salaryInput.max = 15000;
          break;
        case "driver":
          salaryInput.min = 5000;
          salaryInput.max = 20000;
          break;
        case "accountant":
          salaryInput.min = 15000;
          salaryInput.max = 25000;
          break;
        case "scheduler":
          salaryInput.min = 20000;
          salaryInput.max = 25000;
          break;
      }
    }

    function validateForm() {
      if(f1.staff_type.value=="Permanent") {
        var salaryInput = document.getElementById("salary");
        var salary = Number(salaryInput.value); // Convert the salary value to a number
        if (salary < salaryInput.min || salary > salaryInput.max) {
          alert("Salary must be between " + salaryInput.min + " and " + salaryInput.max);
          return false;
        }
      }
      return true;
    }
  </script>
</head>
</body>
  <!-- Rest of the HTML -->
<body onload="valid();">
  <br><br>
  <form method="post" action="/edit_staff_post/" enctype="multipart/form-data" name="f1" onsubmit="return validateForm();">
    {% csrf_token %}
    <table class="table table-bordered table-hover">
      <tr align="center">
        <td colspan="2"><img src="{{data.photo}}" alt="" width="100px" height="100px"></td>
      </tr>
      <tr>
        <th>Staff Name</th>
        <td>
          <input type="text" class="form-control" name="staff_name" value="{{ data.staff_name }}" required>
          <input type="hidden" name="id" value="{{ data.staff_id }}">
        </td>
      </tr>
      <tr>
        <th>Photo</th>
        <td>
          <input type="file" class="form-control" name="photo">
        </td>
      </tr>
      <tr>
        <tr>
          <th>Date of Birth</th>
          <td><input type="date" class="form-control" id="dob" name="dob" value="{{ data.dob }}" required></td>
        </tr>
        <tr>
          <th>Nationality</th>
          <td><input type="text" class="form-control" id="nationality" name="nationality" value="{{ data.nationality }}" required></td>
        </tr>
        <tr>
          <th>State</th>
          <td><input type="text" class="form-control" id="state" name="state" value="{{ data.state }}" required></td>
        </tr>
        <tr>
        <th>Address</th>
        <td>
          <input type="text" class="form-control" name="address" value="{{ data.address }}" required>
        </td>
      </tr>
        <tr>
          <th>Pin</th>
          <td>
            <input type="text" class="form-control" name="pin" value="{{ data.pin }}" maxlength="6" required>
          </td>
        </tr>
      <tr>
        <th>Email</th>
        <td>
          <input type="email" class="form-control" name="email" value="{{ data.email }}" readonly>
        </td>
      </tr>
      <tr>
        <th>Phone</th>
        <td>
          <input type="text" class="form-control" name="phone" value="{{ data.phone }}" maxlength="12" required>
        </td>
      </tr>
      <tr>
        <tr>
          <th>Aadhaar</th>
          <td><input type="text" class="form-control" id="aadhaar" name="aadhaar" value="{{ data.aadhaar }}" required></td>
        </tr>
        <tr>
          <tr>
          <tr>
            <th>Qualification</th>
            <td><input type="text" class="form-control" id="qualification" name="qualification" value="{{ data.qualification }}" required></td>
          </tr>
          <tr>
            <tr>
              <th>Remark</th>
              <td><input type="text" class="form-control" id="remark" name="remark" value="{{ data.remark }}" required></td>
            </tr>

            <tr>
              <th>Type</th>
              <td>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="staff_type" id="permanent" value="Permanent" {% if data.type == "Permanent" %}checked="checked"{% endif %} required onChange="valid()">
                  <label class="form-check-label" for="permanent">
                    Permanent
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="staff_type" id="temporary" value="Temporary" {% if data.type == "Temporary" %}checked="checked"{% endif %} required onChange="valid()">
                  <label class="form-check-label" for="temporary">
                    Temporary
                  </label>
                </div>
              </td>
            </tr>
            
        <th>Post</th>
        <td>
          <select class="form-select" id="post" name="post" required onchange="updateSalaryRange();">
            <option value="" disabled {% if not data.post %}selected{% endif %}>Select a post</option>
            <option value="driver" {% if data.post == "driver" %}selected{% endif %}>Driver</option>
            <option value="labour" {% if data.post == "labour" %}selected{% endif %}>Labour</option>
            <option value="accountant" {% if data.post == "accountant" %}selected{% endif %}>Accountant</option>
            <option value="scheduler" {% if data.post == "scheduler" %}selected{% endif %}>Manager</option>
          </select>
        </td>
      </tr>
      </table>
        <table class="table table-bordered table-hover" style="display:none" id="salary_table" width="1500px"> 
          <tr>
            <th style="width:310px">Salary</th>
            <td style="width:960px"><input type="number" class="form-control" id="salary" name="salary" {% if data.type == "Permanent" %}value="{{ data.salary }}"{% endif %}>
          </tr>
        </table>
      
        <div class="text-center">
          <input type="submit" name="button" id="button" value="Update" class="btn btn-primary"/>
        </div>
  </form>

</div>

</body>
{% endblock x %}
